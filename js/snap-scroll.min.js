/*
* SnapScroll v1.2.0 Copyright (c) 2018 AJ Savino
* https://github.com/koga73/SnapScroll
* MIT License
*/
!function(i){function t(e){var n=null,t={callbackDelay:300,_lastOrientation:window.orientation,_timeout:0},i={init:function(){window.addEventListener?(window.addEventListener("resize",i._handler_resize,!1),window.addEventListener("orientationchange",i._handler_resize,!1)):window.attachEvent&&(window.attachEvent("onresize",i._handler_resize),window.attachEvent("onorientationchange",i._handler_resize))},destroy:function(){var e=t._timeout;e&&(clearTimeout(e),t._timeout=0),n.onResize=null,window.removeEventListener?(window.removeEventListener("resize",i._handler_resize),window.removeEventListener("orientationchange",i._handler_resize)):window.detachEvent&&(window.detachEvent("onresize",i._handler_resize),window.detachEvent("onorientationchange",i._handler_resize))},getWidth:function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},getHeight:function(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight},_handler_resize:function(){if("onorientationchange"in window){var e=window.orientation;if(e==t._lastOrientation)return;t._lastOrientation=e}t._timeout&&clearTimeout(t._timeout),t._timeout=setTimeout(i._handler_timeout,n.callbackDelay)},_handler_timeout:function(){clearTimeout(t._timeout),t._timeout=0,n.onResize(n.getWidth(),n.getHeight())}};for(var a in n={callbackDelay:t.callbackDelay,init:i.init,destroy:i.destroy,getWidth:i.getWidth,getHeight:i.getHeight,onResize:null},e)n[a]=e[a];return n.init(),n}i.fn.SnapScroll=function(e){var o=null,n={useClasses:!0,classSnap:"snap-scroll",classVisible:"snap-scroll-visible",classActive:"snap-scroll-active",scrollDelay:300,wheelInterval:1e3,animateDuration:250,animateTimeBuffer:100,snapTop:!0,snapBottom:!0,snaps:[],maxWheelDeviation:100};i.fn.SnapScroll.defaults=n;var s=100,r={_$this:this,_resizer:null,_snaps:null,_currentSnapIndex:-1,_scrollTimeout:0,_lastanimateDuration:0,_wheelDir:0,_lastWheelTime:0,_wheelEventDeltas:[],_wheelEventDeltaAvg:0,_lastWheelEventTime:0},_={init:function(){o.useClasses&&r._$this.addClass(o.classSnap),r._resizer=new t({onResize:_._handler_resize}),_._handler_resize(),i(document).on("scroll",_._handler_document_scroll),i(document).on("keydown",_._handler_document_keydown),i(window).on("DOMMouseScroll mousewheel wheel",_._handler_window_mousewheel)},destroy:function(){i(document).off("scroll",_._handler_document_scroll),i(document).off("keydown",_._handler_document_keydown),i(window).off("DOMMouseScroll mousewheel wheel",_._handler_window_mousewheel),r._resizer&&(r._resizer.destroy(),r._resizer=null),r._snaps=null,r._currentSnapIndex=-1,r._scrollTimeout&&(clearTimeout(r._scrollTimeout),r._scrollTimeout=0),r._lastanimateDuration=0,r._wheelDir=0,r._lastWheelTime=0,r._wheelEventDeltas.splice(0,r._wheelEventDeltas.length),r._wheelEventDeltaAvg=0,r._lastWheelEventTime=0,o.useClasses&&r._$this.removeClass(o.classSnap)},snapClosest:function(){for(var e=_._getScrollPosition(),n=-1,t=-1,i=r._snaps,a=i.length,l=0;l<a;l++){var s=Math.abs(i[l]-e);(-1==t||s<t)&&(t=s,n=l)}o.snapIndex(n)},snapPrev:function(){o.snapIndex(r._currentSnapIndex-1)},snapNext:function(){o.snapIndex(r._currentSnapIndex+1)},snapIndex:function(e){e=Math.min(Math.max(e,0),r._snaps.length-1),r._currentSnapIndex=e;var n=r._snaps[e];if(o.useClasses){var t=null;r._$this.each(function(){var e=i(this);e.removeClass(o.classActive),t||e.offset().top==n&&(t=e)}),t&&t.addClass(o.classActive),_._evalVisibility()}_._scrollTo(n)},getSnapIndex:function(){return r._currentSnapIndex},update:function(){var e=o.snaps.concat(),t=i(document).height()-window.innerHeight;return r._$this.each(function(){e.push(i(this).offset().top)}),o.snapTop&&e.push(0),o.snapBottom&&e.push(t),(e=e.reduce(function(e,n){return-1==e.indexOf(n)&&n<=t&&e.push(n),e},[])).sort(_._sortNumeric),r._snaps=e,r._snaps},isVisible:function(e){var n=e.offset().top,t=n+e.height(),i=_._getScrollPosition(),a=i+window.innerHeight;return i<=n&&n<a||i<t&&t<=a},_evalVisibility:function(){r._$this.each(function(){var e=i(this);o.isVisible(e)?e.addClass(o.classVisible):e.removeClass(o.classVisible)})},_sortNumeric:function(e,n){return e-n},_handler_document_scroll:function(e){o.useClasses&&_._evalVisibility(),r._scrollTimeout&&clearTimeout(r._scrollTimeout);var n=r._lastanimateDuration+o.animateDuration+o.animateTimeBuffer-(new Date).getTime();r._scrollTimeout=setTimeout(_._handler_scroll_timeout,Math.max(o.scrollDelay,n))},_handler_scroll_timeout:function(){clearTimeout(r._scrollTimeout),r._scrollTimeout=0,o.snapClosest()},_scrollTo:function(e){if(_._getScrollPosition()!=e){r._lastanimateDuration=(new Date).getTime();var n=i("html,body");n.stop(!0),n.animate({scrollTop:e},o.animateDuration)}},_handler_window_mousewheel:function(e){e.preventDefault();var n=!1,t=(new Date).getTime();if(r._lastWheelEventTime){var i=t-r._lastWheelEventTime,a=r._wheelEventDeltas.length;a==s&&r._wheelEventDeltas.shift(),r._wheelEventDeltas.push(i),a++,r._wheelEventDeltaAvg=(r._wheelEventDeltaAvg*(a-1)+i)/a,Math.abs(i-r._wheelEventDeltaAvg)>=o.maxWheelDeviation&&(r._wheelEventDeltas.splice(0,a),n=!0)}else n=!0;r._lastWheelEventTime=t;var l=Math.max(-1,Math.min(1,e.originalEvent.deltaY||e.originalEvent.wheelDelta||-e.originalEvent.detail));return r._wheelDir=Math.abs(l)/l,(n||(new Date).getTime()>=r._lastWheelTime+o.wheelInterval)&&_._handler_wheel_timeout(),!1},_handler_wheel_timeout:function(){r._lastWheelTime=(new Date).getTime(),r._wheelDir<0?o.snapPrev():0<r._wheelDir&&o.snapNext()},_handler_document_keydown:function(e){switch(e.keyCode){case 38:o.snapPrev();break;case 40:o.snapNext()}},_handler_resize:function(e,n){o.update(),-1==r._currentSnapIndex?o.snapClosest():o.snapIndex(r._currentSnapIndex)},_getScrollPosition:function(){return window.scrollY||document.body.scrollTop||document.documentElement.scrollTop}};return(o=i.extend({init:_.init,destroy:_.destroy,snapClosest:_.snapClosest,snapPrev:_.snapPrev,snapNext:_.snapNext,snapIndex:_.snapIndex,getSnapIndex:_.getSnapIndex,update:_.update,isVisible:_.isVisible},n,e)).init(),o}}(jQuery);